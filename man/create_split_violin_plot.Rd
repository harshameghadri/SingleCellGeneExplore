% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/split_violin_plot.R
\name{create_split_violin_plot}
\alias{create_split_violin_plot}
\title{Create Split Violin Plots for Single Cell RNA-seq Data}
\usage{
create_split_violin_plot(
  seurat_obj,
  genes,
  celltype_col = "cell.type.ident",
  condition_col = "disease.ident",
  condition_colors = c(CTRL = "dodgerblue2", PAH = "firebrick2"),
  invert_axes = FALSE,
  add_boxplot = TRUE,
  add_mean_se = TRUE,
  plot_title = "Gene Expression by Cell Type",
  alpha_violin = 0.4,
  alpha_boxplot = 0.6,
  boxplot_width = 0.2,
  trim_violin = FALSE,
  ncol_facet = NULL,
  text_size = 12,
  axis_text_angle = 45,
  return_data = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{seurat_obj}{A Seurat object containing single cell RNA-seq data}

\item{genes}{Character vector of gene names to plot. Genes not found in the object
will be reported and excluded}

\item{celltype_col}{Character string specifying the column name in metadata containing
cell type information. Default is "cell.type.ident"}

\item{condition_col}{Character string specifying the column name in metadata containing
condition information. Default is "disease.ident"}

\item{condition_colors}{Named vector of colors for each condition.
Default is c("CTRL" = "dodgerblue2", "PAH" = "firebrick2")}

\item{invert_axes}{Logical. If FALSE (default), genes are on y-axis and cell types on x-axis.
If TRUE, genes are on x-axis and cell types on y-axis}

\item{add_boxplot}{Logical. Whether to overlay boxplots on the violin plots. Default is TRUE}

\item{add_mean_se}{Logical. Whether to add mean Â± standard error points. Default is TRUE}

\item{plot_title}{Character string for the main plot title. Default is "Gene Expression by Cell Type"}

\item{alpha_violin}{Numeric. Transparency level for violin plots (0-1). Default is 0.4}

\item{alpha_boxplot}{Numeric. Transparency level for boxplots (0-1). Default is 0.6}

\item{boxplot_width}{Numeric. Width of boxplots relative to violin width. Default is 0.2}

\item{trim_violin}{Logical. Whether to trim violin plots to data range. Default is FALSE}

\item{ncol_facet}{Integer. Number of columns for faceting when plotting multiple genes.
If NULL, automatically determined}

\item{text_size}{Numeric. Base text size for the plot. Default is 12}

\item{axis_text_angle}{Numeric. Angle for x-axis text rotation in degrees. Default is 45}

\item{return_data}{Logical. If TRUE, returns a list with both plot and data.
If FALSE (default), returns only the plot}

\item{verbose}{Logical. Whether to print progress messages. Default is TRUE}
}
\value{
A ggplot object (or list containing plot and data if return_data = TRUE)
}
\description{
This function creates split violin plots to visualize gene expression differences
between conditions across cell types using single cell RNA-seq data from a Seurat object.
The split violin allows for direct comparison of expression distributions between
two conditions (e.g., CTRL vs PAH) within each cell type.
}
\details{
The function creates split violin plots where each violin is split down the middle,
with each half representing a different condition (e.g., CTRL vs PAH). This allows
for easy visual comparison of expression distributions between conditions within
each cell type.

The function automatically handles:
\itemize{
\item Missing genes (reports and excludes them)
\item Data extraction from Seurat objects
\item Proper faceting for multiple genes
\item Flexible axis orientation
}
}
\examples{
\dontrun{
# Basic usage
p1 <- create_split_violin_plot(
  seurat_obj = pbmc,
  genes = c("CD3D", "CD4", "CD8A"),
  celltype_col = "cell.type.ident",
  condition_col = "disease.ident"
)

# Inverted axes with custom colors
p2 <- create_split_violin_plot(
  seurat_obj = pbmc,
  genes = c("SOD1", "TMBIM6", "CASP3"),
  invert_axes = TRUE,
  condition_colors = c("CTRL" = "blue", "PAH" = "red")
)

# Minimal styling
p3 <- create_split_violin_plot(
  seurat_obj = pbmc,
  genes = c("CD8A", "GZMK"),
  add_boxplot = FALSE,
  add_mean_se = FALSE,
  alpha_violin = 0.7
)
}

}
