% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analyze_metabolism_comprehensive.R
\name{analyze_metabolism_comprehensive}
\alias{analyze_metabolism_comprehensive}
\title{Comprehensive Metabolic Pathway Analysis for Single Cell Data}
\usage{
analyze_metabolism_comprehensive(
  seurat_obj,
  celltype_col = "final.cell.type",
  disease_col = "disease.ident",
  control_label = "CTRL",
  disease_label = "PAH",
  edge_case = FALSE,
  edge_case_celltype = NULL,
  min_cells = 10,
  test_method = "wilcox",
  logfc_threshold = 0.1,
  create_plots = TRUE
)
}
\arguments{
\item{seurat_obj}{A Seurat object containing single cell data with a METABOLISM assay
containing pathway activity scores (typically generated by scMetabolism package)}

\item{celltype_col}{Character. Column name in metadata containing cell type annotations.
Default: "final.cell.type"}

\item{disease_col}{Character. Column name in metadata containing disease/condition labels.
Default: "disease.ident". Only used when edge_case = FALSE}

\item{control_label}{Character. Label for control condition in disease_col.
Default: "CTRL". Used as denominator in fold change calculations}

\item{disease_label}{Character. Label for disease condition in disease_col.
Default: "PAH". Used as numerator in fold change calculations}

\item{edge_case}{Logical. If TRUE, performs edge case analysis (target cell type vs all others).
If FALSE, performs standard disease vs control analysis across all cell types.
Default: FALSE}

\item{edge_case_celltype}{Character. Cell type to compare against all others when edge_case = TRUE.
Must be specified if edge_case = TRUE. Default: NULL}

\item{min_cells}{Integer. Minimum number of cells required per group for analysis.
Groups with fewer cells are skipped. Default: 10}

\item{test_method}{Character. Statistical test method. Options: "wilcox", "t.test".
Default: "wilcox"}

\item{logfc_threshold}{Numeric. Minimum absolute log2 fold change threshold for significance.
Default: 0.1}

\item{create_plots}{Logical. Whether to create visualization plots. Default: TRUE}
}
\value{
A list containing:
\describe{
\item{results}{List of data.frames containing pathway analysis results for each comparison}
\item{summary}{Data.frame summarizing all comparisons with cell counts and success status}
\item{mode}{Character indicating analysis mode: "disease_vs_control" or "edge_case"}
\item{seurat_obj}{Modified Seurat object with additional metadata columns}
}
}
\description{
This function performs comprehensive differential metabolic pathway analysis
between disease and control conditions across all cell types, or compares
a specific cell type against all others (edge case analysis).
}
\details{
The function operates in two modes:

\strong{Standard Mode (edge_case = FALSE):}
\itemize{
\item Compares disease vs control within each cell type
\item Formula: log2(disease/control)
\item Positive log2FC = higher in disease
\item Automatically handles multiple cell types
\item Skips comparisons with insufficient cell numbers
}

\strong{Edge Case Mode (edge_case = TRUE):}
\itemize{
\item Compares specified cell type vs all other cells
\item Useful for rare or disease-enriched cell types
\item Formula: log2(target_celltype/all_others)
}

\strong{Statistical Analysis:}
\itemize{
\item Uses Wilcoxon rank-sum test or t-test
\item Benjamini-Hochberg FDR correction
\item Significance: padj < 0.05 AND |log2FC| > logfc_threshold
}
}
\examples{
\dontrun{
# Load required packages
library(Seurat)
library(dplyr)
library(ggplot2)

# Standard analysis: PAH vs CTRL for each cell type
standard_results <- analyze_metabolism_comprehensive(
  seurat_obj = endothelial_seurat,
  celltype_col = "final.cell.type",
  disease_col = "disease.ident",
  control_label = "CTRL",
  disease_label = "PAH",
  edge_case = FALSE,
  min_cells = 10
)

# View summary
print(standard_results$summary)

# Access specific cell type results
gcap_results <- standard_results$results[["gCAP"]]

# Edge case: Tip cells vs all others
tip_results <- analyze_metabolism_comprehensive(
  seurat_obj = endothelial_seurat,
  edge_case = TRUE,
  edge_case_celltype = "Tip.Like.Cells",
  min_cells = 10
)

# Create visualizations
volcano_plots <- create_comprehensive_volcano_grid(standard_results)
tip_volcano <- create_comprehensive_volcano_grid(tip_results)
}

}
\seealso{
\code{\link{create_comprehensive_volcano_grid}} for visualization functions
\code{\link{compare_metabolism_between_groups}} for underlying comparison function
}
\author{
Sri Harsha Meghadri
}
