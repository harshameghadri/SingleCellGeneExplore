% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perform_and_plot_cell_cycle_analysis_results.R
\name{plot_cell_cycle_analysis}
\alias{plot_cell_cycle_analysis}
\title{Perform and Plot Cell Cycle Analysis Results}
\usage{
plot_cell_cycle_analysis(
  seurat_obj,
  cell_type_column,
  disease_column,
  save_path,
  file_prefix,
  plot_width,
  plot_height,
  reduction_type = "umap",
  s_genes = Seurat::cc.genes.updated.2019$s.genes,
  g2m_genes = Seurat::cc.genes.updated.2019$g2m.genes,
  dot_plot_genes = c("PCNA", "MKI67", "TOP2A", "CCNB1", "CDK1", "MCM5"),
  colors_use = NULL
)
}
\arguments{
\item{seurat_obj}{A Seurat object. Should contain an assay with expression data
(e.g., "RNA"). Metadata should include columns specified by \code{cell_type_column}
and \code{disease_column}.}

\item{cell_type_column}{Character string. The name of the column in
\code{seurat_obj@meta.data} containing cell type annotations.}

\item{disease_column}{Character string. The name of the column in
\code{seurat_obj@meta.data} containing disease status annotations (must have exactly two levels, e.g., "PAH", "CTRL").}

\item{save_path}{Character string. Path to the directory where plots and
statistical results will be saved. The directory will be created if it
doesn't exist.}

\item{file_prefix}{Character string. A prefix to be added to all saved output files.}

\item{plot_width}{Numeric. Width of the saved plots in inches.}

\item{plot_height}{Numeric. Height of the saved plots in inches.}

\item{reduction_type}{Character string. Dimensionality reduction to use for plotting
(e.g., "umap", "tsne"). Defaults to "umap".}

\item{s_genes}{Character vector. Genes defining the S phase. Defaults to
\code{Seurat::cc.genes.updated.2019$s.genes}.}

\item{g2m_genes}{Character vector. Genes defining the G2/M phase. Defaults to
\code{Seurat::cc.genes.updated.2019$g2m.genes}.}

\item{dot_plot_genes}{Character vector. Genes to include in the cell cycle dot plot
(Plot 10). Defaults to \code{c("PCNA", "MKI67", "TOP2A", "CCNB1", "CDK1", "MCM5")}.}

\item{colors_use}{Optional. A character vector of colors to use for discrete plots
(e.g., cell cycle phases, conditions). If \code{NULL} (default), attempts to use
\code{scCustomize::scCustomize_Palette}. If \code{scCustomize} is not available,
uses default \code{ggplot2} colors (\code{scales::hue_pal}).}
}
\value{
Returns the input \code{seurat_obj}, potentially updated with cell cycle scores
("S.Score", "G2M.Score", "Phase" columns in metadata).
}
\description{
Performs cell cycle scoring on a Seurat object (if not already done), conducts
various statistical tests comparing cell cycle phases across cell types and
disease conditions, generates a series of plots visualizing the results, and
saves both the plots and statistical outputs.
}
\details{
The function performs the following steps:
\enumerate{
\item \strong{Cell Cycle Scoring:} Scores cells for S and G2/M phases using \code{Seurat::CellCycleScoring} if "Phase" column is not already present in metadata.
\item \strong{Metadata Validation:} Checks for required columns and ensures the disease column has exactly two levels. Converts relevant columns to factors.
\item \strong{Statistical Analysis:}
\itemize{
\item Overall Chi-squared tests (Cell Type vs Phase, Disease vs Phase).
\item Pairwise Fisher's exact tests (Cell Type vs Phase).
\item Proportion test (or Fisher's if appropriate) for Disease vs Cycling status (G1 vs S/G2M).
\item Odds ratio calculation for Disease vs Cycling status.
\item Logistic regression modeling Cycling status ~ Disease * Cell Type (optional, may fail with sparse data).
\item Pairwise Fisher's exact tests for Disease vs Cycling status within each Cell Type.
}
\item \strong{Save Statistics:} Saves the results of statistical tests to text and CSV files.
\item \strong{Generate Plots:} Creates various plots including UMAPs, violin plots, ridge plots, bar plots, feature plots, a dot plot, density plots, and a logistic regression visualization plot.
\item \strong{Save Plots:} Saves generated plots as both PDF and PNG files.
}

It relies on several packages listed in the \verb{@importFrom} tags. Ensure these are installed.
The \code{scCustomize} package is suggested for enhanced color palettes but not required.
}
